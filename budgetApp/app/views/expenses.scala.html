@(expenses: List[Expense], tagnames: String, tagamounts: String)

@import helper._
 
@main("Expenses | Budgyet") {
        
   	@navBar("", "", "active")
        
		<!-- Centred content -->
	<div class="centredContent">
		<div class="page-header">
			<p class="alignLeft"><h1>Expense Overview
				<p class="alignRight">
				<a data-toggle="modal" href="#createBudgetModal" class="btn btn-primary btn-lg button1"><span class="glyphicon glyphicon-plus"></span></a>
			</p>
			</h1></p>
		</div>
            
	<!-- Filters -->
	<form class="form-inline" role="form">
	    <div class="form-group">Filter by: </div>
	    
	    <div class="form-group">
	        <select class="form-control roundedBorder">
				<option value="" selected disabled>Period</option>
				<option>Current week</option>
				<option>Current month</option>
				<option>Last 31 days</option>
				<option>Last 60 days</option>
				<option>Last 90 Days</option>
				<option>All</option>
	        </select>
	    </div>
	    
	    <div class="form-group">
	        <select class="form-control roundedBorder">
				<option value="" selected disabled>Category</option>
				<option>Salary</option>
				<option>Awards</option>
				<option>Selling</option>
				<option>All</option>
	        </select>
	    </div>
	</form>
        
	<br>
	
   	<!-- Graph -->
    <div class="pieGraph" title="Expense Overview" tags="@tagnames" tagValues="@tagamounts"></div>
    
    <br>
    
	<div class="panel panel-success">
	    <div class="panel-heading">
	        <h3 class="panel-title">Expense Items</h3>
	    </div>
	    <table class="table">
	        <tr>
	            <td><b>Date</b></td>
	            <td></td>
	            <td><b>Item</b></td>
	            <td><b>Category</b></td>
	            <td><b>Amount</b></td>
	            <td></td>
	        </tr>
	    	@for(exp <- expenses) {
	        <tr>
	            <td>@exp.date_display</td>
   	            <td>
	            	@if(exp.scheduler > 0) {
	            		<span class="glyphicon glyphicon-repeat"></span>
            		}
            	</td>
	            <td>@exp.description</td>
	            <td>@exp.tagName</td>
	            <td>@exp.amount</td>
	            <td><a href="@routes.Expenses.showEditExpense(exp.id)"><button type="button" class="btn btn-default btn-xs">Edit</button></a></td>
	        </tr>
	        }
	    </table>
	</div>
    <script>
            
        $(document).ready(function() {
            $('.pieGraph').each(function() {
                var options = {
                    chart: {
                        plotBackgroundColor: '#e9f8e8',
                        plotBorderWidth: null,
                        plotShadow: false
                    },
                    title: {
                        text: $(this).attr('title')
                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>${point.y:.2f}<br>{point.percentage:.1f}%</b>'
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                color: '#000000',
                                connectorColor: '#000000',
                                format: '<b>{point.name}</b>:${point.y:.2f}<br>{point.percentage:.1f}%'
                            }
                        }
                    },
                    series: [{
                        type: 'pie',
                        name: 'Proportion',
                        data: []
                    }]
                };
                
                var tagArray = $(this).attr('tags').split(',');
                var tagValues = $(this).attr('tagValues').split(',');
                
                for(var i=0; i<tagArray.length; i++){
                   options.series[0].data.push({name: tagArray[i], y: parseFloat(tagValues[i])});
                }
                
                $(this).highcharts(options);

            });
        });
            
    </script>
        
}





